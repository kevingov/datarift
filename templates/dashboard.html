<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataRift Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .dashboard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
        }
        .data-card {
            transition: transform 0.3s ease;
            border: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .data-card:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="dashboard-header">
        <div class="container">
            <h1 class="display-5 fw-bold">DataRift Dashboard</h1>
            <p class="lead">Your QuickBooks data at a glance</p>
        </div>
    </div>

    <div class="container my-5">
        <div class="row">
            <div class="col-md-3 mb-4">
                <div class="card data-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">üë• Customers</h5>
                        <p class="card-text">View and manage your customer data</p>
                        <button class="btn btn-primary" onclick="loadData('customers')">Load Customers</button>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card data-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">üìÑ Invoices</h5>
                        <p class="card-text">View and manage your invoice data</p>
                        <button class="btn btn-primary" onclick="loadData('invoices')">Load Invoices</button>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card data-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">üí∞ Payments</h5>
                        <p class="card-text">View and manage your payment data</p>
                        <button class="btn btn-primary" onclick="loadData('payments')">Load Payments</button>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card data-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">ÔøΩÔøΩ Items</h5>
                        <p class="card-text">View and manage your item data</p>
                        <button class="btn btn-primary" onclick="loadData('items')">Load Items</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-3 mb-4">
                <div class="card data-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">üìä QBO-Style Transactions</h5>
                        <p class="card-text">View transactions in QuickBooks Online format</p>
                        <button class="btn btn-success" onclick="loadQBOData()">Load QBO Data</button>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card data-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">üìã Raw Data</h5>
                        <p class="card-text">View all raw transaction data</p>
                        <a href="/raw-data" class="btn btn-warning">View Raw Data</a>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card data-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">üè∑Ô∏è Classes</h5>
                        <p class="card-text">View and manage your class data</p>
                        <button class="btn btn-info" onclick="loadData('classes')">Load Classes</button>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card data-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">üìä All Transactions</h5>
                        <p class="card-text">View unified transaction data</p>
                        <button class="btn btn-secondary" onclick="loadData('transactions')">Load All</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Data Display</h5>
                    </div>
                    <div class="card-body">
                        <div id="data-display">
                            <p class="text-muted text-center">Click a button above to load data</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function loadData(type) {
            const display = document.getElementById("data-display");
            display.innerHTML = "<div class='text-center'><div class='spinner-border' role='status'></div><p class='mt-2'>Loading " + type + "...</p></div>";
            fetch("/api/" + type)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        display.innerHTML = "<div class='alert alert-danger'>" + data.error + "</div>";
                    } else {
                        let html = "<h6>" + type.charAt(0).toUpperCase() + type.slice(1) + " Data</h6>";
                        if (data.length > 0) {
                            html += "<div class='table-responsive'><table class='table table-striped'><thead><tr>";
                            Object.keys(data[0]).forEach(key => {
                                html += "<th>" + key + "</th>";
                            });
                            html += "</tr></thead><tbody>";
                            data.forEach(item => {
                                html += "<tr>";
                                Object.values(item).forEach(value => {
                                    html += "<td>" + (value || "") + "</td>";
                                });
                                html += "</tr>";
                            });
                            html += "</tbody></table></div>";
                        } else {
                            html += "<p class='text-muted'>No data found</p>";
                        }
                        display.innerHTML = html;
                    }
                })
                .catch(error => {
                    display.innerHTML = "<div class='alert alert-danger'>Error: " + error.message + "</div>";
                });
        }

        function loadQBOData() {
            const display = document.getElementById("data-display");
            display.innerHTML = "<div class='text-center'><div class='spinner-border' role='status'></div><p class='mt-2'>Loading QBO-style transactions...</p></div>";
            fetch("/api/transactions/qbo-style")
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        display.innerHTML = "<div class='alert alert-danger'>" + data.error + "</div>";
                    } else {
                        let html = "<h6>QBO-Style Transactions</h6>";
                        if (data.transactions && data.transactions.length > 0) {
                            html += "<div class='table-responsive'><table class='table table-striped'><thead><tr>";
                            Object.keys(data.transactions[0]).forEach(key => {
                                html += "<th>" + key + "</th>";
                            });
                            html += "</tr></thead><tbody>";
                            data.transactions.forEach(item => {
                                html += "<tr>";
                                Object.values(item).forEach(value => {
                                    html += "<td>" + (value || "") + "</td>";
                                });
                                html += "</tr>";
                            });
                            html += "</tbody></table></div>";
                            html += "<div class='mt-3'><a href='/api/transactions/export/qbo-style' class='btn btn-success'>Download CSV</a></div>";
                        } else {
                            html += "<p class='text-muted'>No QBO-style transactions found</p>";
                        }
                        display.innerHTML = html;
                    }
                })
                .catch(error => {
                    display.innerHTML = "<div class='alert alert-danger'>Error: " + error.message + "</div>";
                });
        }
    </script>
</body>
</html>
